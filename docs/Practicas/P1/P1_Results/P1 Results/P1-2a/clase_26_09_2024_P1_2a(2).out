STEP BY STEP SOLUTION FOR P1-(2a)

Calibration data provided (b-frame) :

 Sensor       x1(m)          x2(m)          x3(m)        alpha(deg)      beta(deg)     gamma(deg)  Code  
-------   ------------   ------------   ------------  -------------  -------------  ------------- ------
      0         0.0000         0.0000         0.0000     0.00000000     0.00000000     0.00000000   PLA
      1         0.0000         0.0000        -0.0250     0.26356800    -0.43797400     2.86921400   INS
      2         0.4000        -0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC2
      3         0.4000         0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC3
      4        -0.4000        -0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC4
      5        -0.4000         0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC5
      6         0.7000        -0.1500        -0.0800     0.19654300     0.54167400    -1.35584700   CAM1
      7         0.7000         0.1500        -0.0800    -0.28749500     0.42658800     1.12879200   CAM2

Prior rotation, the b-frame has to be translated to the device providing the navigation angles (2):

b-frame translated to device (2)

Translated vectors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0        -0.4000         0.4000         0.0150   PLA
      1        -0.4000         0.4000        -0.0100   INS
      2         0.0000         0.0000         0.0000   REC2
      3         0.0000         0.8000         0.0000   REC3
      4        -0.8000         0.0000         0.0000   REC4
      5        -0.8000         0.8000         0.0000   REC5
      6         0.3000         0.2500        -0.0650   CAM1
      7         0.3000         0.5500        -0.0650   CAM2

Navigation angles provided:

       roll  =     1.0345940941 deg
       pitch =     2.5550998026 deg
       yaw   =   112.2847481288 deg

NOTE: since they transform from the n-frame(NED) centered in sensor number 2 to the b-frame,
      their sign has to be changed to transform from the b-frame to the n-frame(NED).

----------------------------------------
Rotation from the b-frame to the n-frame
----------------------------------------

Matrix rotation from the b-frame to the n-frame(NED):

Euler angles :

a1 =   -1.0345940941 deg =   -1.1495489934 gon =   -0.0180570734 rad
a2 =   -2.5550998026 deg =   -2.8389997807 gon =   -0.0445949043 rad
a3 = -112.2847481288 deg = -124.7608312542 gon =   -1.9597385546 rad

Rotation matrix :

   -0.3788328537   -0.9254650890   -0.0001949717
    0.9243907623   -0.3784032168    0.0480907895
   -0.0445801247    0.0180381410    0.9988429496

n-frame vectors with origin in device (2)

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0        -0.2187        -0.5204         0.0400   PLA
      1        -0.2187        -0.5216         0.0151   INS
      2         0.0000         0.0000         0.0000   REC2
      3        -0.7404        -0.3027         0.0144   REC3
      4         0.3031        -0.7395         0.0357   REC4
      5        -0.4373        -1.0422         0.0501   REC5
      6        -0.3450         0.1796        -0.0738   CAM1
      7        -0.6226         0.0661        -0.0684   CAM2

----------------------------------------
Rotation from the n-frame to the e-frame
----------------------------------------

By using the e-frame coordinates of the device (2):

     Xo  =       4929475.9686 m   Yo  =        -28861.7071 m  Zo  =    4033747.6040 m
     lat =    39º28'53.13364"     lon =   - 0º20' 7.65096"    hel =         55.8670 m

which provide the following rotation from the n-frame(NED) to the e-frame :


Rotation matrix :

   -0.6358171458    0.0058548236   -0.7718175161
    0.0037226611    0.9999828604    0.0045189329
    0.7718307449    0.0000000000   -0.6358280437

Euler angles :

a1 = -180.0000000000 deg = -200.0000000000 gon =   -3.1415926536 rad
a2 =   50.5185739897 deg =   56.1317488775 gon =    0.8817154495 rad
a3 = -179.6645413989 deg = -199.6272682210 gon =   -3.1357377965 rad

Resulting e-frame vectors with origin in device (2)

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0         0.1051        -0.5210        -0.1942   PLA
      1         0.1243        -0.5223        -0.1783   INS
      2         0.0000         0.0000         0.0000   REC2
      3         0.4578        -0.3054        -0.5806   REC3
      4        -0.2246        -0.7382         0.2112   REC4
      5         0.2333        -1.0436        -0.3694   REC5
      6         0.2774         0.1780        -0.2194   CAM1
      7         0.4490         0.0634        -0.4371   CAM2

The e-frame has to be translated to the device whose coordinates in the e-frame are known (2):



Translated vectors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0         0.1051        -0.5210        -0.1942   PLA
      1         0.1243        -0.5223        -0.1783   INS
      2         0.0000         0.0000         0.0000   REC2
      3         0.4578        -0.3054        -0.5806   REC3
      4        -0.2246        -0.7382         0.2112   REC4
      5         0.2333        -1.0436        -0.3694   REC5
      6         0.2774         0.1780        -0.2194   CAM1
      7         0.4490         0.0634        -0.4371   CAM2

Finally, the e-frame has to be translated from the device (2) to the Earth's center by using
the ECEF coordinates of that device:

     Xo  =       4929475.9686 m   Yo  =        -28861.7071 m  Zo  =    4033747.6040 m



Translated vectors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0   4929476.0737    -28862.2282   4033747.4098   PLA
      1   4929476.0929    -28862.2295   4033747.4257   INS
      2   4929475.9686    -28861.7071   4033747.6040   REC2
      3   4929476.4264    -28862.0125   4033747.0234   REC3
      4   4929475.7440    -28862.4453   4033747.8153   REC4
      5   4929476.2019    -28862.7507   4033747.2346   REC5
      6   4929476.2460    -28861.5292   4033747.3846   CAM1
      7   4929476.4176    -28861.6437   4033747.1669   CAM2

-----------------
Final coordinates
-----------------



e-frame ECEF coordinates (ETRS89) of all sensors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0   4929476.0737    -28862.2282   4033747.4098   PLA
      1   4929476.0929    -28862.2295   4033747.4257   INS
      2   4929475.9686    -28861.7071   4033747.6040   REC2
      3   4929476.4264    -28862.0125   4033747.0234   REC3
      4   4929475.7440    -28862.4453   4033747.8153   REC4
      5   4929476.2019    -28862.7507   4033747.2346   REC5
      6   4929476.2460    -28861.5292   4033747.3846   CAM1
      7   4929476.4176    -28861.6437   4033747.1669   CAM2

e-frame geodetic coordinates (ETRS89) of all sensors :

Sensor         Latitude           Longitude        h.ell(m)      N (m)    Code
-------     ---------------    ----------------   ---------    --------  
      0     39º28'53.12655"    - 0º20' 7.67274"     55.8270     50.0166   PLA
      1     39º28'53.12655"    - 0º20' 7.67279"     55.8519     50.0166   INS
      2     39º28'53.13364"    - 0º20' 7.65096"     55.8670     50.0166   REC2
      3     39º28'53.10963"    - 0º20' 7.66363"     55.8526     50.0166   REC3
      4     39º28'53.14346"    - 0º20' 7.68191"     55.8313     50.0166   REC4
      5     39º28'53.11946"    - 0º20' 7.69457"     55.8169     50.0166   REC5
      6     39º28'53.12245"    - 0º20' 7.64345"     55.9408     50.0166   CAM1
      7     39º28'53.11345"    - 0º20' 7.64820"     55.9354     50.0166   CAM2

e-frame TMzn  coordinates (ETRS89) of all sensors :

Sensor          E              N       zn    H.or(m)    Code
-------    -----------   ------------  --  ----------    
      0    729171.0812   4373592.4830  30      5.8104   PLA
      1    729171.0800   4373592.4830  30      5.8354   INS
      2    729171.5950   4373592.7170  30      5.8504   REC2
      3    729171.3142   4373591.9678  30      5.8360   REC3
      4    729170.8467   4373592.9981  30      5.8147   REC4
      5    729170.5659   4373592.2489  30      5.8003   REC5
      6    729171.7848   4373592.3774  30      5.9242   CAM1
      7    729171.6795   4373592.0964  30      5.9188   CAM2

Verification by using the initial GNSS coordinates. Differences expresed in ETRS89-TM(30): 

Sensor           x1(m)          x2(m)          x3(m)   Code
-------      ----------     ----------     ----------  
      2         0.0000         0.0000         0.0000   REC2
      3         0.0118         0.0082         0.0000   REC3
      4         0.0233         0.0029         0.0000   REC4
      5         0.0181         0.0010         0.0000   REC5

