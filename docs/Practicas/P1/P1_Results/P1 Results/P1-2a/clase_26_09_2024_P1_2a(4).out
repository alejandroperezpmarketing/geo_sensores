STEP BY STEP SOLUTION FOR P1-(2a)

Calibration data provided (b-frame) :

 Sensor       x1(m)          x2(m)          x3(m)        alpha(deg)      beta(deg)     gamma(deg)  Code  
-------   ------------   ------------   ------------  -------------  -------------  ------------- ------
      0         0.0000         0.0000         0.0000     0.00000000     0.00000000     0.00000000   PLA
      1         0.0000         0.0000        -0.0250     0.26356800    -0.43797400     2.86921400   INS
      2         0.4000        -0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC2
      3         0.4000         0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC3
      4        -0.4000        -0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC4
      5        -0.4000         0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC5
      6         0.7000        -0.1500        -0.0800     0.19654300     0.54167400    -1.35584700   CAM1
      7         0.7000         0.1500        -0.0800    -0.28749500     0.42658800     1.12879200   CAM2

Prior rotation, the b-frame has to be translated to the device providing the navigation angles (4):

b-frame translated to device (4)

Translated vectors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0         0.4000         0.4000         0.0150   PLA
      1         0.4000         0.4000        -0.0100   INS
      2         0.8000         0.0000         0.0000   REC2
      3         0.8000         0.8000         0.0000   REC3
      4         0.0000         0.0000         0.0000   REC4
      5         0.0000         0.8000         0.0000   REC5
      6         1.1000         0.2500        -0.0650   CAM1
      7         1.1000         0.5500        -0.0650   CAM2

Navigation angles provided:

       roll  =     1.0346007566 deg
       pitch =     2.5551024560 deg
       yaw   =   112.2847427825 deg

NOTE: since they transform from the n-frame(NED) centered in sensor number 4 to the b-frame,
      their sign has to be changed to transform from the b-frame to the n-frame(NED).

----------------------------------------
Rotation from the b-frame to the n-frame
----------------------------------------

Matrix rotation from the b-frame to the n-frame(NED):

Euler angles :

a1 =   -1.0346007566 deg =   -1.1495563963 gon =   -0.0180571896 rad
a2 =   -2.5551024560 deg =   -2.8390027289 gon =   -0.0445949506 rad
a3 = -112.2847427825 deg = -124.7608253139 gon =   -1.9597384613 rad

Rotation matrix :

   -0.3788327666   -0.9254651247   -0.0001948772
    0.9243907958   -0.3784031241    0.0480908763
   -0.0445801710    0.0180382571    0.9988429454

n-frame vectors with origin in device (4)

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0        -0.5217         0.2191         0.0044   PLA
      1        -0.5217         0.2179        -0.0206   INS
      2        -0.3031         0.7395        -0.0357   REC2
      3        -1.0434         0.4368        -0.0212   REC3
      4         0.0000         0.0000         0.0000   REC4
      5        -0.7404        -0.3027         0.0144   REC5
      6        -0.6481         0.9191        -0.1095   CAM1
      7        -0.9257         0.8056        -0.1040   CAM2

----------------------------------------
Rotation from the n-frame to the e-frame
----------------------------------------

By using the e-frame coordinates of the device (4):

     Xo  =       4929475.7827 m   Yo  =        -28862.4222 m  Zo  =    4033747.8498 m
     lat =    39º28'53.14353"     lon =   - 0º20' 7.68093"    hel =         55.8830 m

which provide the following rotation from the n-frame(NED) to the e-frame :


Rotation matrix :

   -0.6358171823    0.0058549689   -0.7718174849
    0.0037227536    0.9999828595    0.0045190448
    0.7718307144    0.0000000000   -0.6358280807

Euler angles :

a1 = -180.0000000000 deg = -200.0000000000 gon =   -3.1415926536 rad
a2 =   50.5185712403 deg =   56.1317458225 gon =    0.8817154015 rad
a3 = -179.6645330756 deg = -199.6272589728 gon =   -3.1357376512 rad

Resulting e-frame vectors with origin in device (4)

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0         0.3296         0.2172        -0.4055   PLA
      1         0.3489         0.2159        -0.3896   INS
      2         0.2246         0.7382        -0.2112   REC2
      3         0.6824         0.4328        -0.7919   REC3
      4         0.0000         0.0000         0.0000   REC4
      5         0.4578        -0.3054        -0.5806   REC5
      6         0.5019         0.9162        -0.4306   CAM1
      7         0.6736         0.8017        -0.6483   CAM2

The e-frame has to be translated to the device whose coordinates in the e-frame are known (4):



Translated vectors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0         0.3296         0.2172        -0.4055   PLA
      1         0.3489         0.2159        -0.3896   INS
      2         0.2246         0.7382        -0.2112   REC2
      3         0.6824         0.4328        -0.7919   REC3
      4         0.0000         0.0000         0.0000   REC4
      5         0.4578        -0.3054        -0.5806   REC5
      6         0.5019         0.9162        -0.4306   CAM1
      7         0.6736         0.8017        -0.6483   CAM2

Finally, the e-frame has to be translated from the device (4) to the Earth's center by using
the ECEF coordinates of that device:

     Xo  =       4929475.7827 m   Yo  =        -28862.4222 m  Zo  =    4033747.8498 m



Translated vectors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0   4929476.1123    -28862.2050   4033747.4443   PLA
      1   4929476.1316    -28862.2063   4033747.4602   INS
      2   4929476.0072    -28861.6840   4033747.6386   REC2
      3   4929476.4650    -28861.9894   4033747.0579   REC3
      4   4929475.7827    -28862.4222   4033747.8498   REC4
      5   4929476.2405    -28862.7276   4033747.2692   REC5
      6   4929476.2846    -28861.5060   4033747.4192   CAM1
      7   4929476.4563    -28861.6205   4033747.2015   CAM2

-----------------
Final coordinates
-----------------



e-frame ECEF coordinates (ETRS89) of all sensors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0   4929476.1123    -28862.2050   4033747.4443   PLA
      1   4929476.1316    -28862.2063   4033747.4602   INS
      2   4929476.0072    -28861.6840   4033747.6386   REC2
      3   4929476.4650    -28861.9894   4033747.0579   REC3
      4   4929475.7827    -28862.4222   4033747.8498   REC4
      5   4929476.2405    -28862.7276   4033747.2692   REC5
      6   4929476.2846    -28861.5060   4033747.4192   CAM1
      7   4929476.4563    -28861.6205   4033747.2015   CAM2

e-frame geodetic coordinates (ETRS89) of all sensors :

Sensor         Latitude           Longitude        h.ell(m)      N (m)    Code
-------     ---------------    ----------------   ---------    --------  
      0     39º28'53.12662"    - 0º20' 7.67176"     55.8786     50.0166   PLA
      1     39º28'53.12662"    - 0º20' 7.67181"     55.9036     50.0166   INS
      2     39º28'53.13371"    - 0º20' 7.64998"     55.9187     50.0166   REC2
      3     39º28'53.10970"    - 0º20' 7.66265"     55.9042     50.0166   REC3
      4     39º28'53.14354"    - 0º20' 7.68093"     55.8830     50.0166   REC4
      5     39º28'53.11953"    - 0º20' 7.69359"     55.8686     50.0166   REC5
      6     39º28'53.12252"    - 0º20' 7.64247"     55.9925     50.0166   CAM1
      7     39º28'53.11352"    - 0º20' 7.64722"     55.9870     50.0166   CAM2

e-frame TMzn  coordinates (ETRS89) of all sensors :

Sensor          E              N       zn    H.or(m)    Code
-------    -----------   ------------  --  ----------    
      0    729171.1045   4373592.4859  30      5.8620   PLA
      1    729171.1033   4373592.4858  30      5.8870   INS
      2    729171.6183   4373592.7199  30      5.9021   REC2
      3    729171.3376   4373591.9707  30      5.8877   REC3
      4    729170.8700   4373593.0010  30      5.8664   REC4
      5    729170.5892   4373592.2518  30      5.8520   REC5
      6    729171.8081   4373592.3803  30      5.9759   CAM1
      7    729171.7028   4373592.0993  30      5.9705   CAM2

Verification by using the initial GNSS coordinates. Differences expresed in ETRS89-TM(30): 

Sensor           x1(m)          x2(m)          x3(m)   Code
-------      ----------     ----------     ----------  
      2        -0.0233        -0.0029         0.0000   REC2
      3        -0.0116         0.0053         0.0000   REC3
      4         0.0000         0.0000         0.0000   REC4
      5        -0.0052        -0.0018         0.0000   REC5

