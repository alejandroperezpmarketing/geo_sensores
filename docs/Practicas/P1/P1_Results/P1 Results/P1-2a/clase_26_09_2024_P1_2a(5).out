STEP BY STEP SOLUTION FOR P1-(2a)

Calibration data provided (b-frame) :

 Sensor       x1(m)          x2(m)          x3(m)        alpha(deg)      beta(deg)     gamma(deg)  Code  
-------   ------------   ------------   ------------  -------------  -------------  ------------- ------
      0         0.0000         0.0000         0.0000     0.00000000     0.00000000     0.00000000   PLA
      1         0.0000         0.0000        -0.0250     0.26356800    -0.43797400     2.86921400   INS
      2         0.4000        -0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC2
      3         0.4000         0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC3
      4        -0.4000        -0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC4
      5        -0.4000         0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC5
      6         0.7000        -0.1500        -0.0800     0.19654300     0.54167400    -1.35584700   CAM1
      7         0.7000         0.1500        -0.0800    -0.28749500     0.42658800     1.12879200   CAM2

Prior rotation, the b-frame has to be translated to the device providing the navigation angles (5):

b-frame translated to device (5)

Translated vectors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0         0.4000        -0.4000         0.0150   PLA
      1         0.4000        -0.4000        -0.0100   INS
      2         0.8000        -0.8000         0.0000   REC2
      3         0.8000         0.0000         0.0000   REC3
      4         0.0000        -0.8000         0.0000   REC4
      5         0.0000         0.0000         0.0000   REC5
      6         1.1000        -0.5500        -0.0650   CAM1
      7         1.1000        -0.2500        -0.0650   CAM2

Navigation angles provided:

       roll  =     1.0346036160 deg
       pitch =     2.5550957324 deg
       yaw   =   112.2847406251 deg

NOTE: since they transform from the n-frame(NED) centered in sensor number 5 to the b-frame,
      their sign has to be changed to transform from the b-frame to the n-frame(NED).

----------------------------------------
Rotation from the b-frame to the n-frame
----------------------------------------

Matrix rotation from the b-frame to the n-frame(NED):

Euler angles :

a1 =   -1.0346036160 deg =   -1.1495595733 gon =   -0.0180572396 rad
a2 =   -2.5550957324 deg =   -2.8389952582 gon =   -0.0445948332 rad
a3 = -112.2847406251 deg = -124.7608229168 gon =   -1.9597384237 rad

Rotation matrix :

   -0.3788327338   -0.9254651381   -0.0001947847
    0.9243908149   -0.3784030888    0.0480907868
   -0.0445800538    0.0180383070    0.9988429498

n-frame vectors with origin in device (5)

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0         0.2187         0.5218        -0.0101   PLA
      1         0.2187         0.5206        -0.0350   INS
      2         0.4373         1.0422        -0.0501   REC2
      3        -0.3031         0.7395        -0.0357   REC3
      4         0.7404         0.3027        -0.0144   REC4
      5         0.0000         0.0000         0.0000   REC5
      6         0.0923         1.2218        -0.1239   CAM1
      7        -0.1853         1.1083        -0.1185   CAM2

----------------------------------------
Rotation from the n-frame to the e-frame
----------------------------------------

By using the e-frame coordinates of the device (5):

     Xo  =       4929476.2396 m   Yo  =        -28862.7329 m  Zo  =    4033747.2662 m
     lat =    39º28'53.11947"     lon =   - 0º20' 7.69382"    hel =         55.8660 m

which provide the following rotation from the n-frame(NED) to the e-frame :


Rotation matrix :

   -0.6358170921    0.0058550314   -0.7718175588
    0.0037227928    0.9999828592    0.0045190935
    0.7718307886    0.0000000000   -0.6358279907

Euler angles :

a1 = -180.0000000000 deg = -200.0000000000 gon =   -3.1415926536 rad
a2 =   50.5185779239 deg =   56.1317532488 gon =    0.8817155182 rad
a3 = -179.6645294956 deg = -199.6272549951 gon =   -3.1357375887 rad

Resulting e-frame vectors with origin in device (5)

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0        -0.1282         0.5226         0.1752   PLA
      1        -0.1089         0.5213         0.1910   INS
      2        -0.2333         1.0436         0.3694   REC2
      3         0.2246         0.7382        -0.2112   REC3
      4        -0.4578         0.3054         0.5806   REC4
      5         0.0000         0.0000         0.0000   REC5
      6         0.0441         1.2216         0.1500   CAM1
      7         0.2158         1.1071        -0.0677   CAM2

The e-frame has to be translated to the device whose coordinates in the e-frame are known (5):



Translated vectors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0        -0.1282         0.5226         0.1752   PLA
      1        -0.1089         0.5213         0.1910   INS
      2        -0.2333         1.0436         0.3694   REC2
      3         0.2246         0.7382        -0.2112   REC3
      4        -0.4578         0.3054         0.5806   REC4
      5         0.0000         0.0000         0.0000   REC5
      6         0.0441         1.2216         0.1500   CAM1
      7         0.2158         1.1071        -0.0677   CAM2

Finally, the e-frame has to be translated from the device (5) to the Earth's center by using
the ECEF coordinates of that device:

     Xo  =       4929476.2396 m   Yo  =        -28862.7329 m  Zo  =    4033747.2662 m



Translated vectors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0   4929476.1114    -28862.2103   4033747.4414   PLA
      1   4929476.1306    -28862.2116   4033747.4573   INS
      2   4929476.0063    -28861.6892   4033747.6356   REC2
      3   4929476.4641    -28861.9947   4033747.0550   REC3
      4   4929475.7817    -28862.4275   4033747.8469   REC4
      5   4929476.2396    -28862.7329   4033747.2662   REC5
      6   4929476.2836    -28861.5113   4033747.4163   CAM1
      7   4929476.4553    -28861.6258   4033747.1985   CAM2

-----------------
Final coordinates
-----------------



e-frame ECEF coordinates (ETRS89) of all sensors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0   4929476.1114    -28862.2103   4033747.4414   PLA
      1   4929476.1306    -28862.2116   4033747.4573   INS
      2   4929476.0063    -28861.6892   4033747.6356   REC2
      3   4929476.4641    -28861.9947   4033747.0550   REC3
      4   4929475.7817    -28862.4275   4033747.8469   REC4
      5   4929476.2396    -28862.7329   4033747.2662   REC5
      6   4929476.2836    -28861.5113   4033747.4163   CAM1
      7   4929476.4553    -28861.6258   4033747.1985   CAM2

e-frame geodetic coordinates (ETRS89) of all sensors :

Sensor         Latitude           Longitude        h.ell(m)      N (m)    Code
-------     ---------------    ----------------   ---------    --------  
      0     39º28'53.12656"    - 0º20' 7.67198"     55.8761     50.0166   PLA
      1     39º28'53.12656"    - 0º20' 7.67203"     55.9010     50.0166   INS
      2     39º28'53.13365"    - 0º20' 7.65021"     55.9161     50.0166   REC2
      3     39º28'53.10965"    - 0º20' 7.66287"     55.9017     50.0166   REC3
      4     39º28'53.14348"    - 0º20' 7.68115"     55.8804     50.0166   REC4
      5     39º28'53.11947"    - 0º20' 7.69382"     55.8660     50.0166   REC5
      6     39º28'53.12247"    - 0º20' 7.64269"     55.9899     50.0166   CAM1
      7     39º28'53.11346"    - 0º20' 7.64744"     55.9845     50.0166   CAM2

e-frame TMzn  coordinates (ETRS89) of all sensors :

Sensor          E              N       zn    H.or(m)    Code
-------    -----------   ------------  --  ----------    
      0    729171.0993   4373592.4840  30      5.8595   PLA
      1    729171.0981   4373592.4840  30      5.8844   INS
      2    729171.6131   4373592.7180  30      5.8995   REC2
      3    729171.3323   4373591.9689  30      5.8851   REC3
      4    729170.8648   4373592.9992  30      5.8638   REC4
      5    729170.5840   4373592.2500  30      5.8494   REC5
      6    729171.8028   4373592.3784  30      5.9733   CAM1
      7    729171.6976   4373592.0975  30      5.9679   CAM2

Verification by using the initial GNSS coordinates. Differences expresed in ETRS89-TM(30): 

Sensor           x1(m)          x2(m)          x3(m)   Code
-------      ----------     ----------     ----------  
      2        -0.0181        -0.0010         0.0000   REC2
      3        -0.0063         0.0072         0.0000   REC3
      4         0.0052         0.0018         0.0000   REC4
      5         0.0000         0.0000         0.0000   REC5

