STEP BY STEP SOLUTION FOR P1-(2a)

Calibration data provided (b-frame) :

 Sensor       x1(m)          x2(m)          x3(m)        alpha(deg)      beta(deg)     gamma(deg)  Code  
-------   ------------   ------------   ------------  -------------  -------------  ------------- ------
      0         0.0000         0.0000         0.0000     0.00000000     0.00000000     0.00000000   PLA
      1         0.0000         0.0000        -0.0250     0.26356800    -0.43797400     2.86921400   INS
      2         0.4000        -0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC2
      3         0.4000         0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC3
      4        -0.4000        -0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC4
      5        -0.4000         0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC5
      6         0.7000        -0.1500        -0.0800     0.19654300     0.54167400    -1.35584700   CAM1
      7         0.7000         0.1500        -0.0800    -0.28749500     0.42658800     1.12879200   CAM2

Prior rotation, the b-frame has to be translated to the device providing the navigation angles (0):

b-frame translated to device (0)

Translated vectors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0         0.0000         0.0000         0.0000   PLA
      1         0.0000         0.0000        -0.0250   INS
      2         0.4000        -0.4000        -0.0150   REC2
      3         0.4000         0.4000        -0.0150   REC3
      4        -0.4000        -0.4000        -0.0150   REC4
      5        -0.4000         0.4000        -0.0150   REC5
      6         0.7000        -0.1500        -0.0800   CAM1
      7         0.7000         0.1500        -0.0800   CAM2

Navigation angles provided:

       roll  =     1.0345988149 deg
       pitch =     2.5550977895 deg
       yaw   =   112.2847444085 deg

NOTE: since they transform from the n-frame(NED) centered in sensor number 0 to the b-frame,
      their sign has to be changed to transform from the b-frame to the n-frame(NED).

----------------------------------------
Rotation from the b-frame to the n-frame
----------------------------------------

Matrix rotation from the b-frame to the n-frame(NED):

Euler angles :

a1 =   -1.0345988149 deg =   -1.1495542388 gon =   -0.0180571558 rad
a2 =   -2.5550977895 deg =   -2.8389975439 gon =   -0.0445948691 rad
a3 = -112.2847444085 deg = -124.7608271206 gon =   -1.9597384897 rad

Rotation matrix :

   -0.3788327942   -0.9254651134   -0.0001948790
    0.9243907884   -0.3784031534    0.0480907882
   -0.0445800896    0.0180382233    0.9988429497

n-frame vectors with origin in device (0)

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0         0.0000         0.0000         0.0000   PLA
      1         0.0000        -0.0012        -0.0250   INS
      2         0.2187         0.5204        -0.0400   REC2
      3        -0.5217         0.2177        -0.0256   REC3
      4         0.5217        -0.2191        -0.0044   REC4
      5        -0.2187        -0.5218         0.0101   REC5
      6        -0.1263         0.7000        -0.1138   CAM1
      7        -0.4040         0.5865        -0.1084   CAM2

----------------------------------------
Rotation from the n-frame to the e-frame
----------------------------------------

By using the e-frame coordinates of the device (0):

     Xo  =       4929476.0985 m   Yo  =        -28862.2156 m  Zo  =    4033747.4336 m
     lat =    39º28'53.12663"     lon =   - 0º20' 7.67221"    hel =         55.8612 m

which provide the following rotation from the n-frame(NED) to the e-frame :


Rotation matrix :

   -0.6358171193    0.0058549266   -0.7718175372
    0.0037227264    0.9999828598    0.0045190125
    0.7718307665    0.0000000000   -0.6358280175

Euler angles :

a1 = -180.0000000000 deg = -200.0000000000 gon =   -3.1415926536 rad
a2 =   50.5185759353 deg =   56.1317510393 gon =    0.8817154835 rad
a3 = -179.6645354974 deg = -199.6272616638 gon =   -3.1357376935 rad

Resulting e-frame vectors with origin in device (0)

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0         0.0000         0.0000         0.0000   PLA
      1         0.0193        -0.0013         0.0159   INS
      2        -0.1051         0.5210         0.1942   REC2
      3         0.3527         0.2156        -0.3864   REC3
      4        -0.3296        -0.2172         0.4055   REC4
      5         0.1282        -0.5226        -0.1752   REC5
      6         0.1723         0.6990        -0.0251   CAM1
      7         0.3440         0.5845        -0.2429   CAM2

The e-frame has to be translated to the device whose coordinates in the e-frame are known (0):



Translated vectors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0         0.0000         0.0000         0.0000   PLA
      1         0.0193        -0.0013         0.0159   INS
      2        -0.1051         0.5210         0.1942   REC2
      3         0.3527         0.2156        -0.3864   REC3
      4        -0.3296        -0.2172         0.4055   REC4
      5         0.1282        -0.5226        -0.1752   REC5
      6         0.1723         0.6990        -0.0251   CAM1
      7         0.3440         0.5845        -0.2429   CAM2

Finally, the e-frame has to be translated from the device (0) to the Earth's center by using
the ECEF coordinates of that device:

     Xo  =       4929476.0985 m   Yo  =        -28862.2156 m  Zo  =    4033747.4336 m



Translated vectors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0   4929476.0985    -28862.2156   4033747.4336   PLA
      1   4929476.1178    -28862.2170   4033747.4495   INS
      2   4929475.9935    -28861.6946   4033747.6278   REC2
      3   4929476.4513    -28862.0000   4033747.0472   REC3
      4   4929475.7689    -28862.4328   4033747.8391   REC4
      5   4929476.2267    -28862.7382   4033747.2585   REC5
      6   4929476.2708    -28861.5167   4033747.4085   CAM1
      7   4929476.4425    -28861.6312   4033747.1907   CAM2

-----------------
Final coordinates
-----------------



e-frame ECEF coordinates (ETRS89) of all sensors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0   4929476.0985    -28862.2156   4033747.4336   PLA
      1   4929476.1178    -28862.2170   4033747.4495   INS
      2   4929475.9935    -28861.6946   4033747.6278   REC2
      3   4929476.4513    -28862.0000   4033747.0472   REC3
      4   4929475.7689    -28862.4328   4033747.8391   REC4
      5   4929476.2267    -28862.7382   4033747.2585   REC5
      6   4929476.2708    -28861.5167   4033747.4085   CAM1
      7   4929476.4425    -28861.6312   4033747.1907   CAM2

e-frame geodetic coordinates (ETRS89) of all sensors :

Sensor         Latitude           Longitude        h.ell(m)      N (m)    Code
-------     ---------------    ----------------   ---------    --------  
      0     39º28'53.12663"    - 0º20' 7.67221"     55.8612     50.0166   PLA
      1     39º28'53.12663"    - 0º20' 7.67226"     55.8862     50.0166   INS
      2     39º28'53.13372"    - 0º20' 7.65043"     55.9013     50.0166   REC2
      3     39º28'53.10972"    - 0º20' 7.66310"     55.8868     50.0166   REC3
      4     39º28'53.14355"    - 0º20' 7.68138"     55.8656     50.0166   REC4
      5     39º28'53.11954"    - 0º20' 7.69404"     55.8512     50.0166   REC5
      6     39º28'53.12254"    - 0º20' 7.64292"     55.9751     50.0166   CAM1
      7     39º28'53.11353"    - 0º20' 7.64767"     55.9697     50.0166   CAM2

e-frame TMzn  coordinates (ETRS89) of all sensors :

Sensor          E              N       zn    H.or(m)    Code
-------    -----------   ------------  --  ----------    
      0    729171.0937   4373592.4860  30      5.8447   PLA
      1    729171.0925   4373592.4860  30      5.8696   INS
      2    729171.6076   4373592.7200  30      5.8847   REC2
      3    729171.3268   4373591.9708  30      5.8703   REC3
      4    729170.8592   4373593.0011  30      5.8490   REC4
      5    729170.5785   4373592.2520  30      5.8346   REC5
      6    729171.7973   4373592.3804  30      5.9585   CAM1
      7    729171.6920   4373592.0994  30      5.9531   CAM2

Verification by using the initial GNSS coordinates. Differences expresed in ETRS89-TM(30): 

Sensor           x1(m)          x2(m)          x3(m)   Code
-------      ----------     ----------     ----------  
      2        -0.0126        -0.0030         0.0000   REC2
      3        -0.0008         0.0052         0.0000   REC3
      4         0.0108        -0.0001         0.0000   REC4
      5         0.0055        -0.0020         0.0000   REC5

