STEP BY STEP SOLUTION FOR P1-(2b)

Calibration data provided (b-frame) :

 Sensor       x1(m)          x2(m)          x3(m)        alpha(deg)      beta(deg)     gamma(deg)  Code  
-------   ------------   ------------   ------------  -------------  -------------  ------------- ------
      0         0.0000         0.0000         0.0000     0.00000000     0.00000000     0.00000000   PLA
      1         0.0000         0.0000        -0.0250     0.26356800    -0.43797400     2.86921400   INS
      2         0.4000        -0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC2
      3         0.4000         0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC3
      4        -0.4000        -0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC4
      5        -0.4000         0.4000        -0.0150     0.00000000     0.00000000     0.00000000   REC5
      6         0.7000        -0.1500        -0.0800     0.19654300     0.54167400    -1.35584700   CAM1
      7         0.7000         0.1500        -0.0800    -0.28749500     0.42658800     1.12879200   CAM2

Navigation angles provided by the INS :

       roll  =     1.0345967928 deg
       pitch =     2.5550931671 deg
       yaw   =   112.2847460977 deg

NOTE: They describe the attitude of the s-frame(INS) with regard a n-frame(NED) with the northing 
      coordinate pointing towwards the magnetic north. Therefore, the calibration parametres and the declination
      value has to be included into the computations.

----------------------------------------
Rotation from the s-frame to the b-frame
----------------------------------------
Prior rotation, the b-frame has to be translated to the device providing the navigation angles (1):

Calibration angles provided for the device (1) to transform from the s-frame(INS) to the b-frame(PLATFORM):

       alpha =     0.2635680000 deg
       beta  =    -0.4379740000 deg
       gamma =     2.8692140000 deg


Rotation from the b-frame(PLATFORM) to the s-frame(INS)

Euler angles :

a1 =   -0.2635680000 deg =   -0.2928533333 gon =   -0.0046001294 rad
a2 =    0.4379740000 deg =    0.4866377778 gon =    0.0076440883 rad
a3 =   -2.8692140000 deg =   -3.1880155556 gon =   -0.0500772312 rad

Rotation matrix :

    0.9987172182   -0.0500908935   -0.0074040859
    0.0500548414    0.9987340700   -0.0049769735
    0.0076440139    0.0045999788    0.9999602038

--------------------------------------------------------------
Rotation from the s-frame (INS) to the n-frame(Magnetic North)
--------------------------------------------------------------


Rotation from the s-frame(INS) to the n-frame(MN)

Euler angles :

a1 =   -1.0345967928 deg =   -1.1495519920 gon =   -0.0180571205 rad
a2 =   -2.5550931671 deg =   -2.8389924079 gon =   -0.0445947885 rad
a3 = -112.2847460977 deg = -124.7608289974 gon =   -1.9597385192 rad

Rotation matrix :

   -0.3788328229   -0.9254651016   -0.0001948826
    0.9243907805   -0.3784031837    0.0480907003
   -0.0445800090    0.0180381881    0.9988429539

-------------------------------------------------------------------------
Rotation from the n-frame(Magnetic North) to the n-frame (Geodetic North)
-------------------------------------------------------------------------

Declination provided for the device (1) to transform from the Magnetic North to the Geodetic North:

       declination =    -0.7000000000 deg


Rotation from the n-frame(MN) to the n-frame(GN)

Euler angles :

a1 =    0.0000000000 deg =    0.0000000000 gon =    0.0000000000 rad
a2 =    0.0000000000 deg =    0.0000000000 gon =    0.0000000000 rad
a3 =   -0.7000000000 deg =   -0.7777777778 gon =   -0.0122173048 rad

Rotation matrix :

    0.9999253697   -0.0122170008   -0.0000000000
    0.0122170008    0.9999253697    0.0000000000
    0.0000000000   -0.0000000000    1.0000000000

--------------------------------------------------------------------------------------
Total rotation from the b-frame to the n-frame (GN) by using the INS navigation angles
--------------------------------------------------------------------------------------


Rotation matrix :

   -0.4356925542   -0.9000706976    0.0066886201
    0.8993759479   -0.4350351269    0.0432127602
   -0.0359847545    0.0248430619    0.9990435024

Euler angles :

a1 =   -1.4244718173 deg =   -1.5827464637 gon =   -0.0248617233 rad
a2 =   -2.0622197874 deg =   -2.2913553194 gon =   -0.0359925252 rad
a3 = -115.8473456682 deg = -128.7192729646 gon =   -2.0219176116 rad

Rotation from the b-frame to the n-frame(NED) by using the INS navigation angles:

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0         0.0000         0.0000         0.0000   PLA
      1        -0.0002        -0.0011        -0.0250   INS
      2         0.1857         0.5331        -0.0393   REC2
      3        -0.5344         0.1851        -0.0194   REC3
      4         0.5342        -0.1864        -0.0105   REC4
      5        -0.1859        -0.5344         0.0093   REC5
      6        -0.1705         0.6914        -0.1088   CAM1
      7        -0.4405         0.5609        -0.1014   CAM2

n-frame vectors with origin in device (3)

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0         0.0000         0.0000         0.0000   PLA
      1        -0.0002        -0.0011        -0.0250   INS
      2         0.1857         0.5331        -0.0393   REC2
      3        -0.5344         0.1851        -0.0194   REC3
      4         0.5342        -0.1864        -0.0105   REC4
      5        -0.1859        -0.5344         0.0093   REC5
      6        -0.1705         0.6914        -0.1088   CAM1
      7        -0.4405         0.5609        -0.1014   CAM2

----------------------------------------
Rotation from the n-frame to the e-frame
----------------------------------------

By using the e-frame coordinates of the device (3):

     Xo  =       4929476.4033 m   Yo  =        -28862.0004 m  Zo  =    4033747.0145 m
     lat =    39º28'53.10989"     lon =   - 0º20' 7.66313"    hel =         55.8290 m

which provide the following rotation from the n-frame(NED) to the e-frame :


Rotation matrix :

   -0.6358170568    0.0058548826   -0.7718175890
    0.0037226980    0.9999828600    0.0045189788
    0.7718308182    0.0000000000   -0.6358279548

Euler angles :

a1 = -180.0000000000 deg = -200.0000000000 gon =   -3.1415926536 rad
a2 =   50.5185805875 deg =   56.1317562083 gon =    0.8817155647 rad
a3 = -179.6645380197 deg = -199.6272644664 gon =   -3.1357377375 rad

Resulting e-frame vectors with origin in device (3)

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0         0.0000         0.0000         0.0000   PLA
      1         0.0194        -0.0012         0.0158   INS
      2        -0.0846         0.5336         0.1683   REC2
      3         0.3559         0.1830        -0.4001   REC3
      4        -0.3326        -0.1844         0.4190   REC4
      5         0.1078        -0.5351        -0.1494   REC5
      6         0.1965         0.6902        -0.0624   CAM1
      7         0.3616         0.5587        -0.2756   CAM2

The e-frame has to be translated to the device whose coordinates in the e-frame are known (3):



Translated vectors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0        -0.3559        -0.1830         0.4001   PLA
      1        -0.3365        -0.1842         0.4159   INS
      2        -0.4404         0.3506         0.5684   REC2
      3         0.0000         0.0000         0.0000   REC3
      4        -0.6885        -0.3674         0.8191   REC4
      5        -0.2480        -0.7181         0.2507   REC5
      6        -0.1594         0.5072         0.3377   CAM1
      7         0.0058         0.3757         0.1246   CAM2

Finally, the e-frame has to be translated from the device (3) to the Earth's center by using
the ECEF coordinates of that device:

     Xo  =       4929476.4033 m   Yo  =        -28862.0004 m  Zo  =    4033747.0145 m



Translated vectors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0   4929476.0474    -28862.1834   4033747.4146   PLA
      1   4929476.0668    -28862.1846   4033747.4303   INS
      2   4929475.9629    -28861.6498   4033747.5829   REC2
      3   4929476.4033    -28862.0004   4033747.0145   REC3
      4   4929475.7148    -28862.3679   4033747.8336   REC4
      5   4929476.1553    -28862.7185   4033747.2652   REC5
      6   4929476.2439    -28861.4932   4033747.3522   CAM1
      7   4929476.4091    -28861.6247   4033747.1390   CAM2

-----------------
Final coordinates
-----------------



e-frame ECEF coordinates (ETRS89) of all sensors :

Sensor        x1(m)          x2(m)          x3(m)      Code
-------   ------------   ------------   ------------
      0   4929476.0474    -28862.1834   4033747.4146   PLA
      1   4929476.0668    -28862.1846   4033747.4303   INS
      2   4929475.9629    -28861.6498   4033747.5829   REC2
      3   4929476.4033    -28862.0004   4033747.0145   REC3
      4   4929475.7148    -28862.3679   4033747.8336   REC4
      5   4929476.1553    -28862.7185   4033747.2652   REC5
      6   4929476.2439    -28861.4932   4033747.3522   CAM1
      7   4929476.4091    -28861.6247   4033747.1390   CAM2

e-frame geodetic coordinates (ETRS89) of all sensors :

Sensor         Latitude           Longitude        h.ell(m)      N (m)    Code
-------     ---------------    ----------------   ---------    --------  
      0     39º28'53.12721"    - 0º20' 7.67087"     55.8096     50.0166   PLA
      1     39º28'53.12721"    - 0º20' 7.67092"     55.8345     50.0166   INS
      2     39º28'53.13323"    - 0º20' 7.64857"     55.8489     50.0166   REC2
      3     39º28'53.10989"    - 0º20' 7.66313"     55.8290     50.0166   REC3
      4     39º28'53.14453"    - 0º20' 7.67867"     55.8201     50.0166   REC4
      5     39º28'53.12119"    - 0º20' 7.69323"     55.8002     50.0166   REC5
      6     39º28'53.12168"    - 0º20' 7.64195"     55.9184     50.0166   CAM1
      7     39º28'53.11293"    - 0º20' 7.64741"     55.9109     50.0166   CAM2

e-frame TMzn  coordinates (ETRS89) of all sensors :

Sensor          E              N       zn    H.or(m)    Code
-------    -----------   ------------  --  ----------    
      0    729171.1251   4373592.5048  30      5.7930   PLA
      1    729171.1241   4373592.5046  30      5.8179   INS
      2    729171.6526   4373592.7062  30      5.8323   REC2
      3    729171.3260   4373591.9760  30      5.8124   REC3
      4    729170.9230   4373593.0334  30      5.8035   REC4
      5    729170.5963   4373592.3032  30      5.7836   REC5
      6    729171.8214   4373592.3548  30      5.9018   CAM1
      7    729171.6989   4373592.0810  30      5.8944   CAM2

Verification by using the initial GNSS coordinates. Differences expresed in ETRS89-TM(30): 

Sensor           x1(m)          x2(m)          x3(m)   Code
-------      ----------     ----------     ----------  
      2        -0.0577         0.0108         0.0000   REC2
      3         0.0000         0.0000         0.0000   REC3
      4        -0.0530        -0.0324         0.0000   REC4
      5        -0.0123        -0.0532         0.0000   REC5

